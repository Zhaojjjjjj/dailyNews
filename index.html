<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>新闻联播文字稿</title>
		<link rel="stylesheet" href="web/github-markdown.min.css" />
		<script src="web/showdown.min.js"></script>
	</head>
	<body>
		<div id="header">
			<div class="header-content">
				<h1 class="site-title">《新闻联播》文字稿</h1>
				<p class="site-subtitle">每日自动更新 · 权威新闻归档</p>
			</div>
			<nav class="nav-tabs">
				<a href="index.html" class="nav-item active">首页</a>
				<a href="web/archive.html" class="nav-item">完整归档</a>
			</nav>
		</div>
		<div id="container">
			<!-- 统计信息卡片 -->
			<div class="stats-section">
				<div class="stat-card">
					<div class="stat-number" id="total-count">-</div>
					<div class="stat-label">总计文字稿</div>
				</div>
				<div class="stat-card">
					<div class="stat-number" id="latest-date">-</div>
					<div class="stat-label">最新更新</div>
				</div>
				<div class="stat-card">
					<div class="stat-number" id="total-news">-</div>
					<div class="stat-label">累计新闻</div>
				</div>
			</div>

			<!-- 最新内容 -->
			<div class="content-section">
				<h2 class="section-title">最新文字稿</h2>
				<div id="latest-list" class="news-list">
					<div class="loading">
						<div class="spinner"></div>
						<p>加载中...</p>
					</div>
				</div>
			</div>
		</div>
		<div id="footer">
			<p>&copy; 2022-2025 新闻联播文字稿归档 | 数据来源: CCTV</p>
		</div>
		<style>
			/* ========== 全局样式 ========== */
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			html {
				font-size: 16px;
				scroll-behavior: smooth;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif;
				line-height: 1.6;
				color: #333;
				background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
				min-height: 100vh;
				display: flex;
				flex-direction: column;
			}

			/* ========== 顶部导航栏 ========== */
			#header {
				background: linear-gradient(135deg, #c41e3a 0%, #8b1a2e 100%);
				color: white;
				box-shadow: 0 2px 8px rgba(196, 30, 58, 0.3);
				position: sticky;
				top: 0;
				z-index: 1000;
				border-bottom: 3px solid #d4af37;
			}

			.header-content {
				max-width: 1200px;
				margin: 0 auto;
				padding: 1.5rem 2rem 1rem;
				text-align: center;
			}

			.site-title {
				font-size: 2rem;
				font-weight: 700;
				margin-bottom: 0.3rem;
				text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
				letter-spacing: 2px;
			}

			.site-subtitle {
				font-size: 0.95rem;
				opacity: 0.95;
				font-weight: 300;
			}

			/* 导航标签 */
			.nav-tabs {
				max-width: 1200px;
				margin: 0 auto;
				display: flex;
				justify-content: center;
				gap: 0;
				padding: 0 2rem;
			}

			.nav-item {
				padding: 0.8rem 2rem;
				color: rgba(255, 255, 255, 0.8);
				text-decoration: none;
				border-bottom: 3px solid transparent;
				transition: all 0.3s ease;
				font-weight: 500;
			}

			.nav-item:hover {
				color: white;
				background: rgba(255, 255, 255, 0.1);
			}

			.nav-item.active {
				color: white;
				border-bottom-color: #d4af37;
				background: rgba(255, 255, 255, 0.1);
			}

			/* ========== 主容器 ========== */
			#container {
				flex: 1;
				max-width: 1200px;
				width: 100%;
				margin: 2rem auto;
				padding: 0 1rem;
			}

			/* ========== 统计卡片 ========== */
			.stats-section {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
				gap: 1.5rem;
				margin-bottom: 2rem;
			}

			.stat-card {
				background: white;
				padding: 2rem;
				border-radius: 8px;
				box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
				text-align: center;
				transition: all 0.3s ease;
				border-top: 4px solid #c41e3a;
			}

			.stat-card:hover {
				transform: translateY(-5px);
				box-shadow: 0 4px 20px rgba(196, 30, 58, 0.2);
			}

			.stat-number {
				font-size: 2.5rem;
				font-weight: 700;
				color: #c41e3a;
				margin-bottom: 0.5rem;
			}

			.stat-label {
				font-size: 0.95rem;
				color: #666;
				font-weight: 500;
			}

			/* ========== 内容区域 ========== */
			.content-section {
				background: white;
				padding: 2rem;
				border-radius: 8px;
				box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
			}

			.section-title {
				color: #2c3e50;
				font-size: 1.5rem;
				font-weight: 600;
				margin-bottom: 1.5rem;
				padding-bottom: 0.8rem;
				border-bottom: 2px solid #f0f0f0;
			}

			/* ========== 新闻列表 ========== */
			.news-list {
				min-height: 300px;
			}

			.news-item {
				padding: 1.5rem;
				border-bottom: 1px solid #f0f0f0;
				transition: all 0.3s ease;
			}

			.news-item:last-child {
				border-bottom: none;
			}

			.news-item:hover {
				background: #fafafa;
				transform: translateX(5px);
			}

			.news-date {
				display: inline-block;
				background: linear-gradient(135deg, #c41e3a 0%, #8b1a2e 100%);
				color: white;
				padding: 0.3rem 0.8rem;
				border-radius: 4px;
				font-size: 0.9rem;
				font-weight: 600;
				margin-bottom: 0.8rem;
			}

			.news-abstract {
				color: #555;
				line-height: 1.8;
				margin-bottom: 1rem;
				text-align: justify;
			}

			.news-actions {
				display: flex;
				gap: 1rem;
			}

			.btn {
				display: inline-block;
				padding: 0.5rem 1.2rem;
				border-radius: 4px;
				text-decoration: none;
				font-size: 0.9rem;
				font-weight: 500;
				transition: all 0.3s ease;
			}

			.btn-primary {
				background: linear-gradient(135deg, #c41e3a 0%, #8b1a2e 100%);
				color: white;
				box-shadow: 0 2px 4px rgba(196, 30, 58, 0.2);
			}

			.btn-primary:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(196, 30, 58, 0.3);
			}

			.btn-secondary {
				background: white;
				color: #c41e3a;
				border: 1px solid #c41e3a;
			}

			.btn-secondary:hover {
				background: #c41e3a;
				color: white;
			}

			/* 加载动画 */
			.loading {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				min-height: 300px;
				color: #666;
			}

			.spinner {
				width: 50px;
				height: 50px;
				border: 4px solid #f3f3f3;
				border-top: 4px solid #c41e3a;
				border-radius: 50%;
				animation: spin 1s linear infinite;
				margin-bottom: 1rem;
			}

			@keyframes spin {
				0% {
					transform: rotate(0deg);
				}
				100% {
					transform: rotate(360deg);
				}
			}


			/* ========== 底部样式 ========== */
			#footer {
				background: #2c3e50;
				color: white;
				text-align: center;
				padding: 1.5rem;
				margin-top: 3rem;
				font-size: 0.9rem;
			}

			#footer p {
				margin: 0;
				opacity: 0.9;
			}

			/* ========== 响应式设计 ========== */
			@media (max-width: 768px) {
				html {
					font-size: 14px;
				}

				.header-content {
					padding: 1rem 1rem 0.8rem;
				}

				.site-title {
					font-size: 1.5rem;
					letter-spacing: 1px;
				}

				.site-subtitle {
					font-size: 0.85rem;
				}

				.nav-tabs {
					padding: 0 1rem;
				}

				.nav-item {
					padding: 0.6rem 1.2rem;
					font-size: 0.9rem;
				}

				#container {
					margin: 1rem auto;
					padding: 0 0.5rem;
				}

				.stats-section {
					grid-template-columns: 1fr;
					gap: 1rem;
				}

				.stat-card {
					padding: 1.5rem;
				}

				.stat-number {
					font-size: 2rem;
				}

				.content-section {
					padding: 1.5rem 1rem;
				}

				.section-title {
					font-size: 1.3rem;
				}

				.news-item {
					padding: 1rem;
				}

				.news-actions {
					flex-direction: column;
				}

				.btn {
					text-align: center;
				}
			}

			@media (max-width: 480px) {
				.stat-number {
					font-size: 1.8rem;
				}

				.content-section {
					padding: 1rem 0.8rem;
				}

				.news-date {
					font-size: 0.85rem;
					padding: 0.25rem 0.6rem;
				}
			}

			/* ========== 打印样式 ========== */
			@media print {
				#header,
				#footer {
					display: none;
				}

				body {
					background: white;
				}

				.stats-section,
				.content-section {
					box-shadow: none;
				}
			}

			/* ========== 滚动条美化 ========== */
			::-webkit-scrollbar {
				width: 10px;
				height: 10px;
			}

			::-webkit-scrollbar-track {
				background: #f1f1f1;
			}

			::-webkit-scrollbar-thumb {
				background: #c41e3a;
				border-radius: 5px;
			}

			::-webkit-scrollbar-thumb:hover {
				background: #8b1a2e;
			}
		</style>
		<script>
			// 加载数据
			fetch(`public/news/catalogue.json`)
				.then((response) => response.json())
				.then((data) => {
					renderHomePage(data);
				})
				.catch((error) => {
					console.error('加载失败:', error);
					document.getElementById('latest-list').innerHTML = 
						'<div style="text-align:center;padding:2rem;color:#999;">加载失败,请刷新重试</div>';
				});

			function renderHomePage(data) {
				// 更新统计信息
				const totalCount = data.length;
				const latestDate = data[0]?.date || '-';
				const totalNews = totalCount * 19; // 估算,每天约19条新闻

				document.getElementById('total-count').textContent = totalCount;
				document.getElementById('latest-date').textContent = formatDate(latestDate);
				document.getElementById('total-news').textContent = totalNews + '+';

				// 渲染最新10条
				const latestNews = data.slice(0, 10);
				const listContainer = document.getElementById('latest-list');
				
				if (latestNews.length === 0) {
					listContainer.innerHTML = '<div style="text-align:center;padding:2rem;color:#999;">暂无数据</div>';
					return;
				}

				let html = '';
				latestNews.forEach((item) => {
					const date = item.date;
					const abstract = item.abstract.replaceAll('\n', ' ').substring(0, 200) + '...';
					
					html += `
						<div class="news-item">
							<div class="news-date">${formatDate(date)}</div>
							<div class="news-abstract">${abstract}</div>
							<div class="news-actions">
								<a href="web/view.html?date=${date}" class="btn btn-primary">阅读全文</a>
								<a href="web/archive.html#${date}" class="btn btn-secondary">查看归档</a>
							</div>
						</div>
					`;
				});

				listContainer.innerHTML = html;
			}

			// 格式化日期: 20220929 -> 2022-09-29
			function formatDate(dateStr) {
				if (!dateStr || dateStr.length !== 8) return dateStr;
				return `${dateStr.substring(0, 4)}-${dateStr.substring(4, 6)}-${dateStr.substring(6, 8)}`;
			}
		</script>
	</body>
</html>
