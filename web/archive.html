<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>完整归档 - 新闻联播文字稿</title>
		<style>
			/* ========== 全局样式 ========== */
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			html {
				font-size: 16px;
				scroll-behavior: smooth;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif;
				line-height: 1.6;
				color: #333;
				background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
				min-height: 100vh;
				display: flex;
				flex-direction: column;
			}

			/* ========== 顶部导航栏 ========== */
			#header {
				background: linear-gradient(135deg, #c41e3a 0%, #8b1a2e 100%);
				color: white;
				box-shadow: 0 2px 8px rgba(196, 30, 58, 0.3);
				position: sticky;
				top: 0;
				z-index: 1000;
				border-bottom: 3px solid #d4af37;
			}

			.header-content {
				max-width: 1200px;
				margin: 0 auto;
				padding: 1.5rem 2rem 1rem;
				text-align: center;
			}

			.site-title {
				font-size: 2rem;
				font-weight: 700;
				margin-bottom: 0.3rem;
				text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
				letter-spacing: 2px;
			}

			.site-subtitle {
				font-size: 0.95rem;
				opacity: 0.95;
				font-weight: 300;
			}

			/* 导航标签 */
			.nav-tabs {
				max-width: 1200px;
				margin: 0 auto;
				display: flex;
				justify-content: center;
				gap: 0;
				padding: 0 2rem;
			}

			.nav-item {
				padding: 0.8rem 2rem;
				color: rgba(255, 255, 255, 0.8);
				text-decoration: none;
				border-bottom: 3px solid transparent;
				transition: all 0.3s ease;
				font-weight: 500;
			}

			.nav-item:hover {
				color: white;
				background: rgba(255, 255, 255, 0.1);
			}

			.nav-item.active {
				color: white;
				border-bottom-color: #d4af37;
				background: rgba(255, 255, 255, 0.1);
			}

			/* ========== 主容器 ========== */
			#container {
				flex: 1;
				max-width: 1200px;
				width: 100%;
				margin: 2rem auto;
				padding: 0 1rem;
			}

			/* ========== 搜索栏 ========== */
			.search-section {
				background: white;
				padding: 1.5rem;
				border-radius: 8px;
				box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
				margin-bottom: 2rem;
			}

			.search-box {
				display: flex;
				gap: 1rem;
			}

			.search-input {
				flex: 1;
				padding: 0.8rem 1.2rem;
				border: 2px solid #e0e0e0;
				border-radius: 4px;
				font-size: 1rem;
				transition: all 0.3s ease;
			}

			.search-input:focus {
				outline: none;
				border-color: #c41e3a;
				box-shadow: 0 0 0 3px rgba(196, 30, 58, 0.1);
			}

			.search-btn {
				padding: 0.8rem 2rem;
				background: linear-gradient(135deg, #c41e3a 0%, #8b1a2e 100%);
				color: white;
				border: none;
				border-radius: 4px;
				font-size: 1rem;
				font-weight: 600;
				cursor: pointer;
				transition: all 0.3s ease;
			}

			.search-btn:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(196, 30, 58, 0.3);
			}

			/* ========== 归档列表 ========== */
			.archive-section {
				background: white;
				padding: 2rem;
				border-radius: 8px;
				box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
			}

			.section-title {
				color: #2c3e50;
				font-size: 1.5rem;
				font-weight: 600;
				margin-bottom: 1.5rem;
				padding-bottom: 0.8rem;
				border-bottom: 2px solid #f0f0f0;
			}

			.archive-list {
				min-height: 300px;
			}

			.archive-item {
				padding: 1.2rem;
				border-bottom: 1px solid #f0f0f0;
				transition: all 0.3s ease;
				display: flex;
				align-items: center;
				gap: 1.5rem;
			}

			.archive-item:last-child {
				border-bottom: none;
			}

			.archive-item:hover {
				background: #fafafa;
				transform: translateX(5px);
			}

			.archive-date {
				flex-shrink: 0;
				background: linear-gradient(135deg, #c41e3a 0%, #8b1a2e 100%);
				color: white;
				padding: 0.5rem 1rem;
				border-radius: 4px;
				font-size: 0.95rem;
				font-weight: 600;
				min-width: 120px;
				text-align: center;
			}

			.archive-abstract {
				flex: 1;
				color: #555;
				line-height: 1.6;
				font-size: 0.95rem;
			}

			.archive-link {
				flex-shrink: 0;
				padding: 0.5rem 1.2rem;
				background: linear-gradient(135deg, #c41e3a 0%, #8b1a2e 100%);
				color: white;
				text-decoration: none;
				border-radius: 4px;
				font-size: 0.9rem;
				font-weight: 500;
				transition: all 0.3s ease;
			}

			.archive-link:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(196, 30, 58, 0.3);
			}

			/* 加载动画 */
			.loading {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				min-height: 300px;
				color: #666;
			}

			.spinner {
				width: 50px;
				height: 50px;
				border: 4px solid #f3f3f3;
				border-top: 4px solid #c41e3a;
				border-radius: 50%;
				animation: spin 1s linear infinite;
				margin-bottom: 1rem;
			}

			@keyframes spin {
				0% {
					transform: rotate(0deg);
				}
				100% {
					transform: rotate(360deg);
				}
			}

			.no-result {
				text-align: center;
				padding: 3rem;
				color: #999;
			}

			/* ========== 底部样式 ========== */
			#footer {
				background: #2c3e50;
				color: white;
				text-align: center;
				padding: 1.5rem;
				margin-top: 3rem;
				font-size: 0.9rem;
			}

			#footer p {
				margin: 0;
				opacity: 0.9;
			}

			/* ========== 响应式设计 ========== */
			@media (max-width: 768px) {
				html {
					font-size: 14px;
				}

				.header-content {
					padding: 1rem 1rem 0.8rem;
				}

				.site-title {
					font-size: 1.5rem;
					letter-spacing: 1px;
				}

				.site-subtitle {
					font-size: 0.85rem;
				}

				.nav-tabs {
					padding: 0 1rem;
				}

				.nav-item {
					padding: 0.6rem 1.2rem;
					font-size: 0.9rem;
				}

				#container {
					margin: 1rem auto;
					padding: 0 0.5rem;
				}

				.search-section {
					padding: 1rem;
				}

				.search-box {
					flex-direction: column;
				}

				.archive-section {
					padding: 1.5rem 1rem;
				}

				.archive-item {
					flex-direction: column;
					align-items: flex-start;
					gap: 1rem;
				}

				.archive-date {
					min-width: auto;
				}

				.archive-link {
					width: 100%;
					text-align: center;
				}
			}

			@media (max-width: 480px) {
				.search-input {
					font-size: 0.9rem;
				}

				.archive-abstract {
					font-size: 0.9rem;
				}
			}

			/* ========== 滚动条美化 ========== */
			::-webkit-scrollbar {
				width: 10px;
				height: 10px;
			}

			::-webkit-scrollbar-track {
				background: #f1f1f1;
			}

			::-webkit-scrollbar-thumb {
				background: #c41e3a;
				border-radius: 5px;
			}

			::-webkit-scrollbar-thumb:hover {
				background: #8b1a2e;
			}
		</style>
	</head>
	<body>
		<div id="header">
			<div class="header-content">
				<h1 class="site-title">《新闻联播》文字稿</h1>
				<p class="site-subtitle">完整归档 · 历史记录</p>
			</div>
			<nav class="nav-tabs">
				<a href="../index.html" class="nav-item">首页</a>
				<a href="archive.html" class="nav-item active">完整归档</a>
			</nav>
		</div>
		<div id="container">
			<!-- 搜索栏 -->
			<div class="search-section">
				<div class="search-box">
					<input type="text" id="search-input" class="search-input" placeholder="搜索日期或关键词..." />
					<button class="search-btn" onclick="searchArchive()">搜索</button>
				</div>
			</div>

			<!-- 归档列表 -->
			<div class="archive-section">
				<h2 class="section-title">全部文字稿 (<span id="total-count">0</span> 篇)</h2>
				<div id="archive-list" class="archive-list">
					<div class="loading">
						<div class="spinner"></div>
						<p>加载中...</p>
					</div>
				</div>
			</div>
		</div>
		<div id="footer">
			<p>&copy; 2022-2025 新闻联播文字稿归档 | 数据来源: CCTV</p>
		</div>
		<script>
			let allData = [];

			// 加载数据
			fetch(`../public/news/catalogue.json`)
				.then((response) => response.json())
				.then((data) => {
					allData = data;
					renderArchive(data);
				})
				.catch((error) => {
					console.error('加载失败:', error);
					document.getElementById('archive-list').innerHTML = 
						'<div class="no-result">加载失败,请刷新重试</div>';
				});

			function renderArchive(data) {
				const listContainer = document.getElementById('archive-list');
				document.getElementById('total-count').textContent = data.length;

				if (data.length === 0) {
					listContainer.innerHTML = '<div class="no-result">暂无数据</div>';
					return;
				}

				let html = '';
				data.forEach((item) => {
					const date = item.date;
					const abstract = item.abstract.replaceAll('\n', ' ').substring(0, 150) + '...';
					
					html += `
						<div class="archive-item" id="${date}">
							<div class="archive-date">${formatDate(date)}</div>
							<div class="archive-abstract">${abstract}</div>
							<a href="view.html?date=${date}" class="archive-link">阅读全文</a>
						</div>
					`;
				});

				listContainer.innerHTML = html;

				// 处理锚点跳转
				if (window.location.hash) {
					const targetId = window.location.hash.substring(1);
					const targetElement = document.getElementById(targetId);
					if (targetElement) {
						setTimeout(() => {
							targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
							targetElement.style.background = '#fff5f5';
							setTimeout(() => {
								targetElement.style.background = '';
							}, 2000);
						}, 100);
					}
				}
			}

			function searchArchive() {
				const keyword = document.getElementById('search-input').value.trim().toLowerCase();
				
				if (!keyword) {
					renderArchive(allData);
					return;
				}

				const filtered = allData.filter((item) => {
					const date = item.date.toLowerCase();
					const abstract = item.abstract.toLowerCase();
					return date.includes(keyword) || abstract.includes(keyword);
				});

				renderArchive(filtered);

				if (filtered.length === 0) {
					document.getElementById('archive-list').innerHTML = 
						'<div class="no-result">未找到匹配的结果</div>';
				}
			}

			// 回车搜索
			document.getElementById('search-input').addEventListener('keypress', (e) => {
				if (e.key === 'Enter') {
					searchArchive();
				}
			});

			// 格式化日期: 20220929 -> 2022-09-29
			function formatDate(dateStr) {
				if (!dateStr || dateStr.length !== 8) return dateStr;
				return `${dateStr.substring(0, 4)}-${dateStr.substring(4, 6)}-${dateStr.substring(6, 8)}`;
			}
		</script>
	</body>
</html>
